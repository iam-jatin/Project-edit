<%- include("partials/header")%>
    <%- include("partials/navbar")%>
        <div class="container-fluid">
            <div class="row">
                <div class="col-xs-12 col-md-4 col-lg-3 mt-3">
                    <% let i=0; %>
                        <%countData.forEach(el=>{i++%>
                            <div class="card bg-dark mt-4">
                                <div class="card-header text-center header_one">
                                    <h4 class="card-title" style="font-size:1.3vw;">
                                        <%=el.title%> Component Count
                                    </h4>
                                </div>
                                <div class="row">
                                    <div class="col col-md-8 col-sm-8 ">
                                        <div class="text-center pt-1">
                                            <div class="d-flex justify-content-between pl-3">
                                                <div class="card-text primary ">Total Count:</div>
                                                <div class="pl-2" id="count_<%=i%>">
                                                    <%=el.count%>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-center ">
                                            <div class="d-flex justify-content-between pl-3">
                                                <div class="card-text danger ">Rejection Count:</div>
                                                <div class="pl-2" id="rejection_<%=i%>">
                                                    <%=el.rejectionCount%>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-center ">
                                            <div class="d-flex justify-content-between pl-3">
                                                <div class="card-text success ">Ok Count:</div>
                                                <div class="pl-2" id="ok_<%=i%>">
                                                    <%=el.okCount%>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col col-md-4 col-sm-4 p-0">
                                        <div class="donut ">
                                            <canvas id="chDonut_<%=i%>"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <%})%>
                </div>



                <div class=" col-xs-12 col-md-8 col-lg-9 mt-2">
                    <div class="main-div history">
                        <div class="d-flex bar justify-content-between ">
                            <a class="btn btn-outline-info w-25 mr-2" href="/liveData/<%=Machine_No%>">Live</a>
                            <a class="btn btn-outline-warning w-25 mr-2 text-warning"
                                href="/historicalData/<%=Machine_No%>">History</a>

                            <button type="button" class="btn btn-outline-success w-25 mr-2">Tools</button>

                            <div class="btn-group m-auto ">
                                <button class="btn btn-secondary btn-sm dropdown-toggle mr-1" type="button"
                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Select and Download Report
                                </button>
                                <div class="dropdown-menu bg-dark">
                                    <input type="date" name="dateofbirth" id="dateofbirth">
                                    <h5 class="text-white text-center">To</h5>
                                    <input type="date" name="dateofbirth" id="dateofbirth">
                                    <button class="btn btn-primary m-3"><i class="fas fa-download"></i></button>
                                </div>
                            </div>
                            <div class="btn-group dropleft m-auto">
                                <button class="btn btn-secondary btn-sm dropdown-toggle" type="button"
                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Select Machine
                                </button>
                                <div class="dropdown-menu">
                                    <%machine.forEach(m=>{%>
                                        <a class="dropdown-item" href="/historicalData/<%=m.Machine_ID%>">
                                            <%=m.Machine_Name%>
                                        </a>
                                        <%})%>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-12 s-div mt-2">
                        <div class="card bg-dark">
                            <div class="d-flex justify-content-end ml-5">
                                <div class="card-header text-center w-100">Monthly Component Count</div>
                                <!-- <div class="btn-group dropleft m-1">
                                    <button class="btn btn-secondary btn-sm dropdown-toggle" type="button"
                                        data-toggle="dropdown" aria-haspopup="true" aria-expande">
                                        Month
                                    </button>
                                    <div class="dropdown-menu">
                                        <a class="dropdown-item" href="#">January</a>
                                        <a class="dropdown-item" href="#">February</a>
                                        <a class="dropdown-item" href="#">March</a>
                                        <a class="dropdown-item" href="#">Aprily</a>
                                        <a class="dropdown-item" href="#">May</a>
                                        <a class="dropdown-item" href="#">June</a>
                                        <a class="dropdown-item" href="#">July</a>
                                        <a class="dropdown-item" href="#">August</a>
                                        <a class="dropdown-item" href="#">September</a>
                                        <a class="dropdown-item" href="#">October</a>
                                        <a class="dropdown-item" href="#">November</a>
                                        <a class="dropdown-item" href="#">December</a>
                                    </div>
                                </div> -->
                                <div>
                                    <select id="month" class="m-1 btn-group" style="color: black;"
                                        onchange="changeGraph()">

                                    </select>
                                </div>
                                <!-- <div class="btn-group dropleft m-1">
                                    <button class="btn btn-secondary btn-sm dropdown-toggle" type="button"
                                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        Year
                                    </button>
                                    <div class="dropdown-menu">
                                        <a class="dropdown-item" href="#">2021</a>
                                        <a class="dropdown-item" href="#">2020</a>
                                        <a class="dropdown-item" href="#">2019</a>
                                        <a class="dropdown-item" href="#">2018</a>
                                    </div>
                                </div> -->
                                <div>
                                    <select id="year" class="m-1 btn-group" style="color: black;"
                                        onchange="changeGraph()">
                                        <%year.forEach(y=>{%>
                                            <option value="<%=y.year%>" style="color: black;">
                                                <%=y.year%>
                                            </option>
                                            <%})%>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body">
                                <canvas id="bar-chart" style="width:200%;max-width:1200px"></canvas>
                            </div>
                        </div>
                        <div class="card bg-dark mt-3">
                            <div class="d-flex justify-content-end ml-5">
                                <div class="card-header text-center w-100">Hourley Component Count</div>
                                <div class="btn-group dropleft m-auto">
                                    <button class="btn btn-secondary btn-sm dropdown-toggle" type="button"
                                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        Select Shift
                                    </button>
                                    <div class="dropdown-menu">
                                        <%shift.forEach(s=>{%>
                                            <a class="dropdown-item" onclick="plotData('<%=s.shift_no%>')">
                                                Shift <%=s.shift_no%>
                                            </a>
                                            <%})%>

                                    </div>
                                </div>
                            </div>
                            <div class="card-body graph-4">
                                <canvas id="myChart4" style="width:200%;max-width:1200px;"></canvas>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <script>
            const Machine_No = '<%=Machine_No%>';
            let runningShift = '<%=runningShift%>';

            let firstTime = true;
            const date1 = new Date();
            let month = date1.getMonth() + 1;
            let year = date1.getFullYear();
            let day = date.getDate();

            const monthName = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

            const monthEle = document.getElementById("month");
            let m = 0;
            let text = "";
            monthName.forEach(n => {
                m++;
                if (m == month) {
                    text += '<option value=' + m + ' style="color:black" selected>' + n + '</option>';
                }
                else {
                    text += '<option value=' + m + ' style="color:black">' + n + '</option>';
                }
            })
            monthEle.innerHTML = text;

        </script>
        <script src="/Js/plotHistoricalChart.js"></script>
        <script src="/Js/historicalChart.js"></script>
        <%- include("partials/footer")%>